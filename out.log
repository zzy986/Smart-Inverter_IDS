/home/hengj/miniconda3/envs/test/lib/python3.12/site-packages/torch/nn/modules/transformer.py:379: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(
Using device: cuda
0           0.00
1         406.83
2         406.43
3         406.00
4         407.12
           ...  
378929    453.92
378930    454.10
378931    453.37
378932    451.27
378933    428.32
Name: DC_Voltage_Lag, Length: 378934, dtype: float64
(378934, 6)
Training set size: 303147 samples
Validation set size: 37893 samples
Test set size: 37894 samples

Training Transformer...
  0%|          | 0/5000 [00:00<?, ?Epoch/s]  0%|          | 1/5000 [00:02<3:55:18,  2.82s/Epoch]  0%|          | 1/5000 [00:02<3:55:18,  2.82s/Epoch, Train=1.03, Valid=0.766]  0%|          | 2/5000 [00:05<3:38:42,  2.63s/Epoch, Train=1.03, Valid=0.766]  0%|          | 2/5000 [00:05<3:38:42,  2.63s/Epoch, Train=0.882, Valid=0.665]  0%|          | 3/5000 [00:07<3:37:56,  2.62s/Epoch, Train=0.882, Valid=0.665]  0%|          | 3/5000 [00:07<3:37:56,  2.62s/Epoch, Train=0.819, Valid=0.56]   0%|          | 4/5000 [00:10<3:38:56,  2.63s/Epoch, Train=0.819, Valid=0.56]  0%|          | 4/5000 [00:10<3:38:56,  2.63s/Epoch, Train=0.749, Valid=0.477]  0%|          | 5/5000 [00:13<3:36:55,  2.61s/Epoch, Train=0.749, Valid=0.477]  0%|          | 5/5000 [00:13<3:36:55,  2.61s/Epoch, Train=0.648, Valid=0.327]  0%|          | 6/5000 [00:15<3:33:33,  2.57s/Epoch, Train=0.648, Valid=0.327]  0%|          | 6/5000 [00:15<3:33:33,  2.57s/Epoch, Train=0.524, Valid=0.234]  0%|          | 7/5000 [00:18<3:33:39,  2.57s/Epoch, Train=0.524, Valid=0.234]  0%|          | 7/5000 [00:18<3:33:39,  2.57s/Epoch, Train=0.421, Valid=0.218]  0%|          | 8/5000 [00:20<3:36:44,  2.61s/Epoch, Train=0.421, Valid=0.218]  0%|          | 8/5000 [00:20<3:36:44,  2.61s/Epoch, Train=0.362, Valid=0.211]  0%|          | 9/5000 [00:23<3:34:04,  2.57s/Epoch, Train=0.362, Valid=0.211]  0%|          | 9/5000 [00:23<3:34:04,  2.57s/Epoch, Train=0.325, Valid=0.182]  0%|          | 10/5000 [00:25<3:33:49,  2.57s/Epoch, Train=0.325, Valid=0.182]  0%|          | 10/5000 [00:25<3:33:49,  2.57s/Epoch, Train=0.301, Valid=0.17]   0%|          | 11/5000 [00:28<3:36:09,  2.60s/Epoch, Train=0.301, Valid=0.17]  0%|          | 11/5000 [00:28<3:36:09,  2.60s/Epoch, Train=0.284, Valid=0.163]  0%|          | 12/5000 [00:31<3:32:30,  2.56s/Epoch, Train=0.284, Valid=0.163]  0%|          | 12/5000 [00:31<3:32:30,  2.56s/Epoch, Train=0.269, Valid=0.163]  0%|          | 13/5000 [00:33<3:33:03,  2.56s/Epoch, Train=0.269, Valid=0.163]  0%|          | 13/5000 [00:33<3:33:03,  2.56s/Epoch, Train=0.257, Valid=0.15]   0%|          | 14/5000 [00:36<3:35:48,  2.60s/Epoch, Train=0.257, Valid=0.15]  0%|          | 14/5000 [00:36<3:35:48,  2.60s/Epoch, Train=0.245, Valid=0.149]  0%|          | 15/5000 [00:38<3:32:49,  2.56s/Epoch, Train=0.245, Valid=0.149]  0%|          | 15/5000 [00:38<3:32:49,  2.56s/Epoch, Train=0.235, Valid=0.135]  0%|          | 16/5000 [00:41<3:33:46,  2.57s/Epoch, Train=0.235, Valid=0.135]  0%|          | 16/5000 [00:41<3:33:46,  2.57s/Epoch, Train=0.226, Valid=0.133]  0%|          | 17/5000 [00:44<3:39:53,  2.65s/Epoch, Train=0.226, Valid=0.133]  0%|          | 17/5000 [00:44<3:39:53,  2.65s/Epoch, Train=0.218, Valid=0.133]  0%|          | 18/5000 [00:46<3:41:57,  2.67s/Epoch, Train=0.218, Valid=0.133]  0%|          | 18/5000 [00:46<3:41:57,  2.67s/Epoch, Train=0.211, Valid=0.123]  0%|          | 19/5000 [00:49<3:41:28,  2.67s/Epoch, Train=0.211, Valid=0.123]  0%|          | 19/5000 [00:49<3:41:28,  2.67s/Epoch, Train=0.205, Valid=0.124]  0%|          | 20/5000 [00:52<3:42:48,  2.68s/Epoch, Train=0.205, Valid=0.124]  0%|          | 20/5000 [00:52<3:42:48,  2.68s/Epoch, Train=0.199, Valid=0.123]  0%|          | 21/5000 [00:55<3:44:07,  2.70s/Epoch, Train=0.199, Valid=0.123]  0%|          | 21/5000 [00:55<3:44:07,  2.70s/Epoch, Train=0.193, Valid=0.119]  0%|          | 22/5000 [00:57<3:46:23,  2.73s/Epoch, Train=0.193, Valid=0.119]  0%|          | 22/5000 [00:57<3:46:23,  2.73s/Epoch, Train=0.188, Valid=0.118]  0%|          | 23/5000 [01:00<3:49:44,  2.77s/Epoch, Train=0.188, Valid=0.118]  0%|          | 23/5000 [01:00<3:49:44,  2.77s/Epoch, Train=0.183, Valid=0.118]  0%|          | 24/5000 [01:03<3:55:28,  2.84s/Epoch, Train=0.183, Valid=0.118]  0%|          | 24/5000 [01:03<3:55:28,  2.84s/Epoch, Train=0.18, Valid=0.115]   0%|          | 25/5000 [01:06<3:50:42,  2.78s/Epoch, Train=0.18, Valid=0.115]  0%|          | 25/5000 [01:06<3:50:42,  2.78s/Epoch, Train=0.175, Valid=0.117]  1%|          | 26/5000 [01:08<3:42:06,  2.68s/Epoch, Train=0.175, Valid=0.117]  1%|          | 26/5000 [01:08<3:42:06,  2.68s/Epoch, Train=0.172, Valid=0.115]  1%|          | 27/5000 [01:11<3:40:15,  2.66s/Epoch, Train=0.172, Valid=0.115]  1%|          | 27/5000 [01:11<3:40:15,  2.66s/Epoch, Train=0.168, Valid=0.111]  1%|          | 28/5000 [01:14<3:42:29,  2.68s/Epoch, Train=0.168, Valid=0.111]  1%|          | 28/5000 [01:14<3:42:29,  2.68s/Epoch, Train=0.164, Valid=0.115]  1%|          | 29/5000 [01:17<3:48:29,  2.76s/Epoch, Train=0.164, Valid=0.115]  1%|          | 29/5000 [01:17<3:48:29,  2.76s/Epoch, Train=0.16, Valid=0.11]    1%|          | 30/5000 [01:19<3:49:38,  2.77s/Epoch, Train=0.16, Valid=0.11]  1%|          | 30/5000 [01:19<3:49:38,  2.77s/Epoch, Train=0.157, Valid=0.112]  1%|          | 31/5000 [01:22<3:52:34,  2.81s/Epoch, Train=0.157, Valid=0.112]  1%|          | 31/5000 [01:22<3:52:34,  2.81s/Epoch, Train=0.154, Valid=0.112]  1%|          | 32/5000 [01:25<3:55:24,  2.84s/Epoch, Train=0.154, Valid=0.112]  1%|          | 32/5000 [01:25<3:55:24,  2.84s/Epoch, Train=0.151, Valid=0.111]  1%|          | 33/5000 [01:28<3:57:05,  2.86s/Epoch, Train=0.151, Valid=0.111]  1%|          | 33/5000 [01:28<3:57:05,  2.86s/Epoch, Train=0.147, Valid=0.108]  1%|          | 34/5000 [01:31<3:55:15,  2.84s/Epoch, Train=0.147, Valid=0.108]  1%|          | 34/5000 [01:31<3:55:15,  2.84s/Epoch, Train=0.144, Valid=0.111]  1%|          | 35/5000 [01:34<3:56:12,  2.85s/Epoch, Train=0.144, Valid=0.111]  1%|          | 35/5000 [01:34<3:56:12,  2.85s/Epoch, Train=0.141, Valid=0.111]  1%|          | 36/5000 [01:37<3:57:15,  2.87s/Epoch, Train=0.141, Valid=0.111]  1%|          | 36/5000 [01:37<3:57:15,  2.87s/Epoch, Train=0.138, Valid=0.111]  1%|          | 37/5000 [01:40<3:58:13,  2.88s/Epoch, Train=0.138, Valid=0.111]  1%|          | 37/5000 [01:40<3:58:13,  2.88s/Epoch, Train=0.136, Valid=0.107]  1%|          | 38/5000 [01:42<3:55:31,  2.85s/Epoch, Train=0.136, Valid=0.107]  1%|          | 38/5000 [01:42<3:55:31,  2.85s/Epoch, Train=0.133, Valid=0.102]  1%|          | 39/5000 [01:45<3:57:52,  2.88s/Epoch, Train=0.133, Valid=0.102]  1%|          | 39/5000 [01:45<3:57:52,  2.88s/Epoch, Train=0.13, Valid=0.107]   1%|          | 40/5000 [01:48<3:55:54,  2.85s/Epoch, Train=0.13, Valid=0.107]  1%|          | 40/5000 [01:48<3:55:54,  2.85s/Epoch, Train=0.127, Valid=0.108]  1%|          | 41/5000 [01:51<3:57:20,  2.87s/Epoch, Train=0.127, Valid=0.108]  1%|          | 41/5000 [01:51<3:57:20,  2.87s/Epoch, Train=0.124, Valid=0.105]  1%|          | 42/5000 [01:54<3:58:51,  2.89s/Epoch, Train=0.124, Valid=0.105]  1%|          | 42/5000 [01:54<3:58:51,  2.89s/Epoch, Train=0.123, Valid=0.0967]  1%|          | 43/5000 [01:57<3:56:03,  2.86s/Epoch, Train=0.123, Valid=0.0967]  1%|          | 43/5000 [01:57<3:56:03,  2.86s/Epoch, Train=0.12, Valid=0.1]      1%|          | 44/5000 [02:00<3:56:02,  2.86s/Epoch, Train=0.12, Valid=0.1]  1%|          | 44/5000 [02:00<3:56:02,  2.86s/Epoch, Train=0.117, Valid=0.103]  1%|          | 45/5000 [02:03<3:56:31,  2.86s/Epoch, Train=0.117, Valid=0.103]  1%|          | 45/5000 [02:03<3:56:31,  2.86s/Epoch, Train=0.115, Valid=0.0954]  1%|          | 46/5000 [02:05<3:57:57,  2.88s/Epoch, Train=0.115, Valid=0.0954]  1%|          | 46/5000 [02:05<3:57:57,  2.88s/Epoch, Train=0.112, Valid=0.0911]  1%|          | 47/5000 [02:08<3:54:58,  2.85s/Epoch, Train=0.112, Valid=0.0911]  1%|          | 47/5000 [02:08<3:54:58,  2.85s/Epoch, Train=0.111, Valid=0.0977]  1%|          | 48/5000 [02:11<3:55:25,  2.85s/Epoch, Train=0.111, Valid=0.0977]  1%|          | 48/5000 [02:11<3:55:25,  2.85s/Epoch, Train=0.108, Valid=0.0942]  1%|          | 49/5000 [02:14<3:57:24,  2.88s/Epoch, Train=0.108, Valid=0.0942]  1%|          | 49/5000 [02:14<3:57:24,  2.88s/Epoch, Train=0.106, Valid=0.0909]  1%|          | 50/5000 [02:17<3:58:52,  2.90s/Epoch, Train=0.106, Valid=0.0909]  1%|          | 50/5000 [02:17<3:58:52,  2.90s/Epoch, Train=0.105, Valid=0.0861]  1%|          | 51/5000 [02:20<3:59:24,  2.90s/Epoch, Train=0.105, Valid=0.0861]  1%|          | 51/5000 [02:20<3:59:24,  2.90s/Epoch, Train=0.103, Valid=0.088]   1%|          | 52/5000 [02:23<4:04:12,  2.96s/Epoch, Train=0.103, Valid=0.088]  1%|          | 52/5000 [02:23<4:04:12,  2.96s/Epoch, Train=0.101, Valid=0.0867]  1%|          | 53/5000 [02:26<4:06:50,  2.99s/Epoch, Train=0.101, Valid=0.0867]  1%|          | 53/5000 [02:26<4:06:50,  2.99s/Epoch, Train=0.0991, Valid=0.0849]  1%|          | 54/5000 [02:29<4:11:47,  3.05s/Epoch, Train=0.0991, Valid=0.0849]  1%|          | 54/5000 [02:29<4:11:47,  3.05s/Epoch, Train=0.0976, Valid=0.0807]  1%|          | 55/5000 [02:32<4:10:10,  3.04s/Epoch, Train=0.0976, Valid=0.0807]  1%|          | 55/5000 [02:32<4:10:10,  3.04s/Epoch, Train=0.0959, Valid=0.0817]  1%|          | 56/5000 [02:35<4:13:11,  3.07s/Epoch, Train=0.0959, Valid=0.0817]  1%|          | 56/5000 [02:35<4:13:11,  3.07s/Epoch, Train=0.0942, Valid=0.0811]  1%|          | 57/5000 [02:39<4:15:56,  3.11s/Epoch, Train=0.0942, Valid=0.0811]  1%|          | 57/5000 [02:39<4:15:56,  3.11s/Epoch, Train=0.0923, Valid=0.0742]  1%|          | 58/5000 [02:42<4:17:41,  3.13s/Epoch, Train=0.0923, Valid=0.0742]  1%|          | 58/5000 [02:42<4:17:41,  3.13s/Epoch, Train=0.0912, Valid=0.0759]  1%|          | 59/5000 [02:45<4:18:16,  3.14s/Epoch, Train=0.0912, Valid=0.0759]  1%|          | 59/5000 [02:45<4:18:16,  3.14s/Epoch, Train=0.0898, Valid=0.0707]  1%|          | 60/5000 [02:48<4:18:34,  3.14s/Epoch, Train=0.0898, Valid=0.0707]  1%|          | 60/5000 [02:48<4:18:34,  3.14s/Epoch, Train=0.0884, Valid=0.0704]  1%|          | 61/5000 [02:51<4:17:43,  3.13s/Epoch, Train=0.0884, Valid=0.0704]  1%|          | 61/5000 [02:51<4:17:43,  3.13s/Epoch, Train=0.0872, Valid=0.0721]  1%|          | 62/5000 [02:54<4:21:49,  3.18s/Epoch, Train=0.0872, Valid=0.0721]  1%|          | 62/5000 [02:54<4:21:49,  3.18s/Epoch, Train=0.0859, Valid=0.0709]  1%|▏         | 63/5000 [02:57<4:17:42,  3.13s/Epoch, Train=0.0859, Valid=0.0709]  1%|▏         | 63/5000 [02:57<4:17:42,  3.13s/Epoch, Train=0.0845, Valid=0.0661]  1%|▏         | 64/5000 [03:01<4:17:18,  3.13s/Epoch, Train=0.0845, Valid=0.0661]  1%|▏         | 64/5000 [03:01<4:17:18,  3.13s/Epoch, Train=0.0835, Valid=0.0638]  1%|▏         | 65/5000 [03:07<5:40:35,  4.14s/Epoch, Train=0.0835, Valid=0.0638]  1%|▏         | 65/5000 [03:07<5:40:35,  4.14s/Epoch, Train=0.0824, Valid=0.062]   1%|▏         | 66/5000 [03:16<7:33:41,  5.52s/Epoch, Train=0.0824, Valid=0.062]  1%|▏         | 66/5000 [03:16<7:33:41,  5.52s/Epoch, Train=0.0809, Valid=0.0626]  1%|▏         | 67/5000 [03:25<8:54:57,  6.51s/Epoch, Train=0.0809, Valid=0.0626]  1%|▏         | 67/5000 [03:25<8:54:57,  6.51s/Epoch, Train=0.08, Valid=0.0624]    1%|▏         | 68/5000 [03:33<9:50:17,  7.18s/Epoch, Train=0.08, Valid=0.0624]  1%|▏         | 68/5000 [03:33<9:50:17,  7.18s/Epoch, Train=0.079, Valid=0.0609]  1%|▏         | 69/5000 [03:42<10:33:21,  7.71s/Epoch, Train=0.079, Valid=0.0609]  1%|▏         | 69/5000 [03:42<10:33:21,  7.71s/Epoch, Train=0.0776, Valid=0.0585]  1%|▏         | 70/5000 [03:51<11:06:23,  8.11s/Epoch, Train=0.0776, Valid=0.0585]  1%|▏         | 70/5000 [03:51<11:06:23,  8.11s/Epoch, Train=0.0767, Valid=0.0565]  1%|▏         | 71/5000 [04:00<11:25:41,  8.35s/Epoch, Train=0.0767, Valid=0.0565]  1%|▏         | 71/5000 [04:00<11:25:41,  8.35s/Epoch, Train=0.0758, Valid=0.0561]  1%|▏         | 72/5000 [04:09<11:36:35,  8.48s/Epoch, Train=0.0758, Valid=0.0561]  1%|▏         | 72/5000 [04:09<11:36:35,  8.48s/Epoch, Train=0.075, Valid=0.0534]   1%|▏         | 73/5000 [04:17<11:33:15,  8.44s/Epoch, Train=0.075, Valid=0.0534]  1%|▏         | 73/5000 [04:17<11:33:15,  8.44s/Epoch, Train=0.0738, Valid=0.052]  1%|▏         | 74/5000 [04:26<11:39:48,  8.52s/Epoch, Train=0.0738, Valid=0.052]  1%|▏         | 74/5000 [04:26<11:39:48,  8.52s/Epoch, Train=0.073, Valid=0.0523]  2%|▏         | 75/5000 [04:34<11:34:06,  8.46s/Epoch, Train=0.073, Valid=0.0523]  2%|▏         | 75/5000 [04:34<11:34:06,  8.46s/Epoch, Train=0.072, Valid=0.0495]  2%|▏         | 76/5000 [04:43<11:32:10,  8.43s/Epoch, Train=0.072, Valid=0.0495]  2%|▏         | 76/5000 [04:43<11:32:10,  8.43s/Epoch, Train=0.0712, Valid=0.0472]  2%|▏         | 77/5000 [04:51<11:23:41,  8.33s/Epoch, Train=0.0712, Valid=0.0472]  2%|▏         | 77/5000 [04:51<11:23:41,  8.33s/Epoch, Train=0.0701, Valid=0.0472]  2%|▏         | 78/5000 [04:59<11:27:12,  8.38s/Epoch, Train=0.0701, Valid=0.0472]  2%|▏         | 78/5000 [04:59<11:27:12,  8.38s/Epoch, Train=0.0694, Valid=0.0475]  2%|▏         | 79/5000 [05:07<11:18:34,  8.27s/Epoch, Train=0.0694, Valid=0.0475]  2%|▏         | 79/5000 [05:07<11:18:34,  8.27s/Epoch, Train=0.0685, Valid=0.0462]  2%|▏         | 80/5000 [05:16<11:28:17,  8.39s/Epoch, Train=0.0685, Valid=0.0462]  2%|▏         | 80/5000 [05:16<11:28:17,  8.39s/Epoch, Train=0.0677, Valid=0.0453]  2%|▏         | 81/5000 [05:24<11:23:00,  8.33s/Epoch, Train=0.0677, Valid=0.0453]  2%|▏         | 81/5000 [05:24<11:23:00,  8.33s/Epoch, Train=0.0671, Valid=0.0429]  2%|▏         | 82/5000 [05:33<11:30:07,  8.42s/Epoch, Train=0.0671, Valid=0.0429]  2%|▏         | 82/5000 [05:33<11:30:07,  8.42s/Epoch, Train=0.0663, Valid=0.0404]  2%|▏         | 83/5000 [05:41<11:30:00,  8.42s/Epoch, Train=0.0663, Valid=0.0404]  2%|▏         | 83/5000 [05:41<11:30:00,  8.42s/Epoch, Train=0.0656, Valid=0.0406]  2%|▏         | 84/5000 [05:49<11:23:15,  8.34s/Epoch, Train=0.0656, Valid=0.0406]  2%|▏         | 84/5000 [05:49<11:23:15,  8.34s/Epoch, Train=0.0648, Valid=0.0394]  2%|▏         | 85/5000 [05:57<11:14:10,  8.23s/Epoch, Train=0.0648, Valid=0.0394]  2%|▏         | 85/5000 [05:57<11:14:10,  8.23s/Epoch, Train=0.0641, Valid=0.0431]  2%|▏         | 86/5000 [06:06<11:12:41,  8.21s/Epoch, Train=0.0641, Valid=0.0431]  2%|▏         | 86/5000 [06:06<11:12:41,  8.21s/Epoch, Train=0.0635, Valid=0.0416]  2%|▏         | 87/5000 [06:14<11:11:28,  8.20s/Epoch, Train=0.0635, Valid=0.0416]  2%|▏         | 87/5000 [06:14<11:11:28,  8.20s/Epoch, Train=0.0628, Valid=0.0414]  2%|▏         | 88/5000 [06:22<11:11:57,  8.21s/Epoch, Train=0.0628, Valid=0.0414]  2%|▏         | 88/5000 [06:22<11:11:57,  8.21s/Epoch, Train=0.0618, Valid=0.0375]  2%|▏         | 89/5000 [06:30<11:08:26,  8.17s/Epoch, Train=0.0618, Valid=0.0375]  2%|▏         | 89/5000 [06:30<11:08:26,  8.17s/Epoch, Train=0.0618, Valid=0.0344]  2%|▏         | 90/5000 [06:39<11:17:33,  8.28s/Epoch, Train=0.0618, Valid=0.0344]  2%|▏         | 90/5000 [06:39<11:17:33,  8.28s/Epoch, Train=0.0611, Valid=0.0334]  2%|▏         | 91/5000 [06:47<11:18:42,  8.30s/Epoch, Train=0.0611, Valid=0.0334]  2%|▏         | 91/5000 [06:47<11:18:42,  8.30s/Epoch, Train=0.0604, Valid=0.0359]  2%|▏         | 92/5000 [06:55<11:16:51,  8.27s/Epoch, Train=0.0604, Valid=0.0359]  2%|▏         | 92/5000 [06:55<11:16:51,  8.27s/Epoch, Train=0.0598, Valid=0.0431]  2%|▏         | 93/5000 [07:03<11:10:35,  8.20s/Epoch, Train=0.0598, Valid=0.0431]  2%|▏         | 93/5000 [07:03<11:10:35,  8.20s/Epoch, Train=0.0598, Valid=0.0414]  2%|▏         | 94/5000 [07:12<11:12:35,  8.23s/Epoch, Train=0.0598, Valid=0.0414]  2%|▏         | 94/5000 [07:12<11:12:35,  8.23s/Epoch, Train=0.059, Valid=0.0346]   2%|▏         | 95/5000 [07:20<11:13:43,  8.24s/Epoch, Train=0.059, Valid=0.0346]  2%|▏         | 95/5000 [07:20<11:13:43,  8.24s/Epoch, Train=0.0582, Valid=0.0291]  2%|▏         | 96/5000 [07:28<11:14:58,  8.26s/Epoch, Train=0.0582, Valid=0.0291]  2%|▏         | 96/5000 [07:28<11:14:58,  8.26s/Epoch, Train=0.0584, Valid=0.029]   2%|▏         | 97/5000 [07:36<11:13:50,  8.25s/Epoch, Train=0.0584, Valid=0.029]  2%|▏         | 97/5000 [07:36<11:13:50,  8.25s/Epoch, Train=0.058, Valid=0.0326]  2%|▏         | 98/5000 [07:44<11:08:05,  8.18s/Epoch, Train=0.058, Valid=0.0326]  2%|▏         | 98/5000 [07:44<11:08:05,  8.18s/Epoch, Train=0.0567, Valid=0.0397]  2%|▏         | 99/5000 [07:53<11:14:10,  8.25s/Epoch, Train=0.0567, Valid=0.0397]  2%|▏         | 99/5000 [07:53<11:14:10,  8.25s/Epoch, Train=0.0572, Valid=0.0372]  2%|▏         | 100/5000 [08:01<11:15:04,  8.27s/Epoch, Train=0.0572, Valid=0.0372]  2%|▏         | 100/5000 [08:01<11:15:04,  8.27s/Epoch, Train=0.0564, Valid=0.0292]  2%|▏         | 101/5000 [08:09<11:11:56,  8.23s/Epoch, Train=0.0564, Valid=0.0292]  2%|▏         | 101/5000 [08:09<11:11:56,  8.23s/Epoch, Train=0.0554, Valid=0.0265]  2%|▏         | 102/5000 [08:18<11:15:08,  8.27s/Epoch, Train=0.0554, Valid=0.0265]  2%|▏         | 102/5000 [08:18<11:15:08,  8.27s/Epoch, Train=0.0559, Valid=0.0303]  2%|▏         | 103/5000 [08:26<11:20:31,  8.34s/Epoch, Train=0.0559, Valid=0.0303]  2%|▏         | 103/5000 [08:26<11:20:31,  8.34s/Epoch, Train=0.0543, Valid=0.0342]  2%|▏         | 104/5000 [08:34<11:23:12,  8.37s/Epoch, Train=0.0543, Valid=0.0342]  2%|▏         | 104/5000 [08:34<11:23:12,  8.37s/Epoch, Train=0.0536, Valid=0.0327]  2%|▏         | 105/5000 [08:43<11:16:11,  8.29s/Epoch, Train=0.0536, Valid=0.0327]  2%|▏         | 105/5000 [08:43<11:16:11,  8.29s/Epoch, Train=0.0532, Valid=0.0285]  2%|▏         | 106/5000 [08:51<11:16:15,  8.29s/Epoch, Train=0.0532, Valid=0.0285]  2%|▏         | 106/5000 [08:51<11:16:15,  8.29s/Epoch, Train=0.0524, Valid=0.0269]  2%|▏         | 107/5000 [08:59<11:18:58,  8.33s/Epoch, Train=0.0524, Valid=0.0269]  2%|▏         | 107/5000 [08:59<11:18:58,  8.33s/Epoch, Train=0.0521, Valid=0.0299]  2%|▏         | 108/5000 [09:08<11:26:56,  8.43s/Epoch, Train=0.0521, Valid=0.0299]  2%|▏         | 108/5000 [09:08<11:26:56,  8.43s/Epoch, Train=0.0513, Valid=0.031]   2%|▏         | 109/5000 [09:16<11:26:16,  8.42s/Epoch, Train=0.0513, Valid=0.031]  2%|▏         | 109/5000 [09:16<11:26:16,  8.42s/Epoch, Train=0.051, Valid=0.0301]  2%|▏         | 110/5000 [09:24<11:13:47,  8.27s/Epoch, Train=0.051, Valid=0.0301]  2%|▏         | 110/5000 [09:24<11:13:47,  8.27s/Epoch, Train=0.0506, Valid=0.0296]  2%|▏         | 111/5000 [09:33<11:13:14,  8.26s/Epoch, Train=0.0506, Valid=0.0296]  2%|▏         | 111/5000 [09:33<11:13:14,  8.26s/Epoch, Train=0.0501, Valid=0.0281]  2%|▏         | 112/5000 [09:41<11:11:41,  8.25s/Epoch, Train=0.0501, Valid=0.0281]  2%|▏         | 112/5000 [09:41<11:11:41,  8.25s/Epoch, Train=0.0496, Valid=0.0272]  2%|▏         | 113/5000 [09:49<11:21:38,  8.37s/Epoch, Train=0.0496, Valid=0.0272]  2%|▏         | 113/5000 [09:49<11:21:38,  8.37s/Epoch, Train=0.0493, Valid=0.0285]  2%|▏         | 114/5000 [09:58<11:18:47,  8.34s/Epoch, Train=0.0493, Valid=0.0285]  2%|▏         | 114/5000 [09:58<11:18:47,  8.34s/Epoch, Train=0.0493, Valid=0.0296]  2%|▏         | 115/5000 [10:06<11:13:27,  8.27s/Epoch, Train=0.0493, Valid=0.0296]  2%|▏         | 115/5000 [10:06<11:13:27,  8.27s/Epoch, Train=0.0485, Valid=0.0285]  2%|▏         | 116/5000 [10:14<11:15:38,  8.30s/Epoch, Train=0.0485, Valid=0.0285]  2%|▏         | 116/5000 [10:14<11:15:38,  8.30s/Epoch, Train=0.0482, Valid=0.0275]  2%|▏         | 117/5000 [10:23<11:17:21,  8.32s/Epoch, Train=0.0482, Valid=0.0275]  2%|▏         | 117/5000 [10:23<11:17:21,  8.32s/Epoch, Train=0.0477, Valid=0.0272]  2%|▏         | 118/5000 [10:31<11:22:52,  8.39s/Epoch, Train=0.0477, Valid=0.0272]  2%|▏         | 118/5000 [10:31<11:22:52,  8.39s/Epoch, Train=0.0475, Valid=0.0272]  2%|▏         | 119/5000 [10:39<11:19:10,  8.35s/Epoch, Train=0.0475, Valid=0.0272]  2%|▏         | 119/5000 [10:39<11:19:10,  8.35s/Epoch, Train=0.047, Valid=0.0275]   2%|▏         | 120/5000 [10:47<11:10:26,  8.24s/Epoch, Train=0.047, Valid=0.0275]  2%|▏         | 120/5000 [10:47<11:10:26,  8.24s/Epoch, Train=0.0466, Valid=0.0291]  2%|▏         | 121/5000 [10:56<11:12:52,  8.27s/Epoch, Train=0.0466, Valid=0.0291]  2%|▏         | 121/5000 [10:56<11:12:52,  8.27s/Epoch, Train=0.0464, Valid=0.0283]  2%|▏         | 122/5000 [11:04<11:13:50,  8.29s/Epoch, Train=0.0464, Valid=0.0283]  2%|▏         | 122/5000 [11:04<11:13:50,  8.29s/Epoch, Train=0.0461, Valid=0.0273]  2%|▏         | 123/5000 [11:12<11:18:23,  8.35s/Epoch, Train=0.0461, Valid=0.0273]  2%|▏         | 123/5000 [11:12<11:18:23,  8.35s/Epoch, Train=0.0456, Valid=0.0264]  2%|▏         | 124/5000 [11:21<11:15:57,  8.32s/Epoch, Train=0.0456, Valid=0.0264]  2%|▏         | 124/5000 [11:21<11:15:57,  8.32s/Epoch, Train=0.0453, Valid=0.0259]  2%|▎         | 125/5000 [11:29<11:12:48,  8.28s/Epoch, Train=0.0453, Valid=0.0259]  2%|▎         | 125/5000 [11:29<11:12:48,  8.28s/Epoch, Train=0.0452, Valid=0.0271]  3%|▎         | 126/5000 [11:37<11:17:35,  8.34s/Epoch, Train=0.0452, Valid=0.0271]  3%|▎         | 126/5000 [11:37<11:17:35,  8.34s/Epoch, Train=0.0448, Valid=0.0289]  3%|▎         | 127/5000 [11:46<11:31:31,  8.51s/Epoch, Train=0.0448, Valid=0.0289]  3%|▎         | 127/5000 [11:46<11:31:31,  8.51s/Epoch, Train=0.0444, Valid=0.0298]  3%|▎         | 128/5000 [11:54<11:22:21,  8.40s/Epoch, Train=0.0444, Valid=0.0298]  3%|▎         | 128/5000 [11:54<11:22:21,  8.40s/Epoch, Train=0.0445, Valid=0.0286]  3%|▎         | 129/5000 [12:03<11:21:05,  8.39s/Epoch, Train=0.0445, Valid=0.0286]  3%|▎         | 129/5000 [12:03<11:21:05,  8.39s/Epoch, Train=0.0439, Valid=0.0257]  3%|▎         | 130/5000 [12:11<11:21:15,  8.39s/Epoch, Train=0.0439, Valid=0.0257]  3%|▎         | 130/5000 [12:11<11:21:15,  8.39s/Epoch, Train=0.0438, Valid=0.0247]  3%|▎         | 131/5000 [12:20<11:21:15,  8.40s/Epoch, Train=0.0438, Valid=0.0247]  3%|▎         | 131/5000 [12:20<11:21:15,  8.40s/Epoch, Train=0.0445, Valid=0.0272]  3%|▎         | 132/5000 [12:28<11:12:25,  8.29s/Epoch, Train=0.0445, Valid=0.0272]  3%|▎         | 132/5000 [12:28<11:12:25,  8.29s/Epoch, Train=0.0435, Valid=0.0288]  3%|▎         | 133/5000 [12:36<11:11:58,  8.28s/Epoch, Train=0.0435, Valid=0.0288]  3%|▎         | 133/5000 [12:36<11:11:58,  8.28s/Epoch, Train=0.0433, Valid=0.0322]  3%|▎         | 134/5000 [12:44<11:11:17,  8.28s/Epoch, Train=0.0433, Valid=0.0322]  3%|▎         | 134/5000 [12:44<11:11:17,  8.28s/Epoch, Train=0.0442, Valid=0.0297]  3%|▎         | 135/5000 [12:53<11:30:33,  8.52s/Epoch, Train=0.0442, Valid=0.0297]  3%|▎         | 135/5000 [12:53<11:30:33,  8.52s/Epoch, Train=0.0435, Valid=0.024]   3%|▎         | 136/5000 [13:02<11:37:25,  8.60s/Epoch, Train=0.0435, Valid=0.024]  3%|▎         | 136/5000 [13:02<11:37:25,  8.60s/Epoch, Train=0.043, Valid=0.025]   3%|▎         | 137/5000 [13:10<11:30:55,  8.52s/Epoch, Train=0.043, Valid=0.025]  3%|▎         | 137/5000 [13:10<11:30:55,  8.52s/Epoch, Train=0.0436, Valid=0.0275]  3%|▎         | 138/5000 [13:19<11:24:47,  8.45s/Epoch, Train=0.0436, Valid=0.0275]  3%|▎         | 138/5000 [13:19<11:24:47,  8.45s/Epoch, Train=0.0424, Valid=0.0291]  3%|▎         | 139/5000 [13:27<11:24:05,  8.44s/Epoch, Train=0.0424, Valid=0.0291]  3%|▎         | 139/5000 [13:27<11:24:05,  8.44s/Epoch, Train=0.0417, Valid=0.0286]  3%|▎         | 140/5000 [13:35<11:19:21,  8.39s/Epoch, Train=0.0417, Valid=0.0286]  3%|▎         | 140/5000 [13:35<11:19:21,  8.39s/Epoch, Train=0.0416, Valid=0.0256]  3%|▎         | 141/5000 [13:43<11:10:36,  8.28s/Epoch, Train=0.0416, Valid=0.0256]  3%|▎         | 141/5000 [13:43<11:10:36,  8.28s/Epoch, Train=0.0407, Valid=0.0249]  3%|▎         | 142/5000 [13:52<11:10:25,  8.28s/Epoch, Train=0.0407, Valid=0.0249]  3%|▎         | 142/5000 [13:52<11:10:25,  8.28s/Epoch, Train=0.0406, Valid=0.0258]  3%|▎         | 143/5000 [14:00<11:18:59,  8.39s/Epoch, Train=0.0406, Valid=0.0258]  3%|▎         | 143/5000 [14:00<11:18:59,  8.39s/Epoch, Train=0.0402, Valid=0.0279]  3%|▎         | 144/5000 [14:09<11:21:39,  8.42s/Epoch, Train=0.0402, Valid=0.0279]  3%|▎         | 144/5000 [14:09<11:21:39,  8.42s/Epoch, Train=0.0395, Valid=0.0267]  3%|▎         | 145/5000 [14:17<11:17:51,  8.38s/Epoch, Train=0.0395, Valid=0.0267]  3%|▎         | 145/5000 [14:17<11:17:51,  8.38s/Epoch, Train=0.0394, Valid=0.0254]  3%|▎         | 146/5000 [14:25<11:11:01,  8.29s/Epoch, Train=0.0394, Valid=0.0254]  3%|▎         | 146/5000 [14:25<11:11:01,  8.29s/Epoch, Train=0.0389, Valid=0.025]   3%|▎         | 147/5000 [14:35<11:46:11,  8.73s/Epoch, Train=0.0389, Valid=0.025]  3%|▎         | 147/5000 [14:35<11:46:11,  8.73s/Epoch, Train=0.0389, Valid=0.0265]  3%|▎         | 148/5000 [14:46<12:33:05,  9.31s/Epoch, Train=0.0389, Valid=0.0265]  3%|▎         | 148/5000 [14:46<12:33:05,  9.31s/Epoch, Train=0.0385, Valid=0.0265]  3%|▎         | 149/5000 [14:55<12:43:46,  9.45s/Epoch, Train=0.0385, Valid=0.0265]  3%|▎         | 149/5000 [14:55<12:43:46,  9.45s/Epoch, Train=0.0383, Valid=0.0259]  3%|▎         | 150/5000 [15:04<12:18:18,  9.13s/Epoch, Train=0.0383, Valid=0.0259]  3%|▎         | 150/5000 [15:04<12:18:18,  9.13s/Epoch, Train=0.0381, Valid=0.0256]  3%|▎         | 151/5000 [15:12<11:55:37,  8.85s/Epoch, Train=0.0381, Valid=0.0256]  3%|▎         | 151/5000 [15:12<11:55:37,  8.85s/Epoch, Train=0.0379, Valid=0.0246]  3%|▎         | 152/5000 [15:20<11:42:41,  8.70s/Epoch, Train=0.0379, Valid=0.0246]  3%|▎         | 152/5000 [15:20<11:42:41,  8.70s/Epoch, Train=0.0377, Valid=0.0254]  3%|▎         | 153/5000 [15:29<11:33:41,  8.59s/Epoch, Train=0.0377, Valid=0.0254]  3%|▎         | 153/5000 [15:29<11:33:41,  8.59s/Epoch, Train=0.0375, Valid=0.0257]  3%|▎         | 154/5000 [15:37<11:34:32,  8.60s/Epoch, Train=0.0375, Valid=0.0257]  3%|▎         | 154/5000 [15:37<11:34:32,  8.60s/Epoch, Train=0.0373, Valid=0.0258]  3%|▎         | 155/5000 [15:46<11:30:57,  8.56s/Epoch, Train=0.0373, Valid=0.0258]  3%|▎         | 155/5000 [15:46<11:30:57,  8.56s/Epoch, Train=0.0369, Valid=0.0257]  3%|▎         | 156/5000 [15:54<11:21:30,  8.44s/Epoch, Train=0.0369, Valid=0.0257]  3%|▎         | 156/5000 [15:54<11:21:30,  8.44s/Epoch, Train=0.0367, Valid=0.0252]  3%|▎         | 157/5000 [16:02<11:20:25,  8.43s/Epoch, Train=0.0367, Valid=0.0252]  3%|▎         | 157/5000 [16:02<11:20:25,  8.43s/Epoch, Train=0.0366, Valid=0.0252]  3%|▎         | 158/5000 [16:11<11:20:19,  8.43s/Epoch, Train=0.0366, Valid=0.0252]  3%|▎         | 158/5000 [16:11<11:20:19,  8.43s/Epoch, Train=0.0364, Valid=0.0251]  3%|▎         | 159/5000 [16:19<11:22:40,  8.46s/Epoch, Train=0.0364, Valid=0.0251]  3%|▎         | 159/5000 [16:19<11:22:40,  8.46s/Epoch, Train=0.0363, Valid=0.0257]  3%|▎         | 160/5000 [16:28<11:19:34,  8.42s/Epoch, Train=0.0363, Valid=0.0257]  3%|▎         | 160/5000 [16:28<11:19:34,  8.42s/Epoch, Train=0.036, Valid=0.0268]   3%|▎         | 161/5000 [16:36<11:10:11,  8.31s/Epoch, Train=0.036, Valid=0.0268]  3%|▎         | 161/5000 [16:36<11:10:11,  8.31s/Epoch, Train=0.0361, Valid=0.0258]  3%|▎         | 162/5000 [16:44<11:08:07,  8.29s/Epoch, Train=0.0361, Valid=0.0258]  3%|▎         | 162/5000 [16:44<11:08:07,  8.29s/Epoch, Train=0.0358, Valid=0.0244]  3%|▎         | 163/5000 [16:52<11:12:34,  8.34s/Epoch, Train=0.0358, Valid=0.0244]  3%|▎         | 163/5000 [16:52<11:12:34,  8.34s/Epoch, Train=0.0355, Valid=0.0244]  3%|▎         | 164/5000 [17:01<11:18:05,  8.41s/Epoch, Train=0.0355, Valid=0.0244]  3%|▎         | 164/5000 [17:01<11:18:05,  8.41s/Epoch, Train=0.0354, Valid=0.0249]  3%|▎         | 165/5000 [17:09<11:16:18,  8.39s/Epoch, Train=0.0354, Valid=0.0249]  3%|▎         | 165/5000 [17:09<11:16:18,  8.39s/Epoch, Train=0.0355, Valid=0.0252]/home/hengj/zheyu/pythonProject/transformer_2_year_last_moment_2years_batch.py:332: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(f'{model_name}_best_model_last_moment_1A.pth'))
  3%|▎         | 165/5000 [17:09<8:22:56,  6.24s/Epoch, Train=0.0355, Valid=0.0252] 
/home/hengj/miniconda3/envs/test/lib/python3.12/site-packages/torch/nn/modules/loss.py:608: UserWarning: Using a target size (torch.Size([128, 2])) that is different to the input size (torch.Size([128, 1, 2])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return F.mse_loss(input, target, reduction=self.reduction)
/home/hengj/miniconda3/envs/test/lib/python3.12/site-packages/torch/nn/modules/loss.py:608: UserWarning: Using a target size (torch.Size([6, 2])) that is different to the input size (torch.Size([6, 1, 2])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return F.mse_loss(input, target, reduction=self.reduction)
Early stopping triggered!
Transformer Test Loss: 0.3307

Training LSTM...
  0%|          | 0/5000 [00:00<?, ?Epoch/s]/home/hengj/miniconda3/envs/test/lib/python3.12/site-packages/torch/nn/modules/loss.py:608: UserWarning: Using a target size (torch.Size([256, 128, 2])) that is different to the input size (torch.Size([256, 2])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return F.mse_loss(input, target, reduction=self.reduction)
  0%|          | 0/5000 [00:00<?, ?Epoch/s]
Traceback (most recent call last):
  File "/home/hengj/zheyu/pythonProject/transformer_2_year_last_moment_2years_batch.py", line 362, in <module>
    train_losses, valid_losses = train_model(model, train_loader, valid_loader, optimizer, criterion, epochs, early_stopping)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hengj/zheyu/pythonProject/transformer_2_year_last_moment_2years_batch.py", line 295, in train_model
    loss = criterion(predictions, y_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hengj/miniconda3/envs/test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hengj/miniconda3/envs/test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hengj/miniconda3/envs/test/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 608, in forward
    return F.mse_loss(input, target, reduction=self.reduction)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hengj/miniconda3/envs/test/lib/python3.12/site-packages/torch/nn/functional.py", line 3791, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hengj/miniconda3/envs/test/lib/python3.12/site-packages/torch/functional.py", line 76, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (256) must match the size of tensor b (128) at non-singleton dimension 1
